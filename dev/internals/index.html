<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Internals · MLJModelRegistryTools.jl</title><meta name="title" content="Internals · MLJModelRegistryTools.jl"/><meta property="og:title" content="Internals · MLJModelRegistryTools.jl"/><meta property="twitter:title" content="Internals · MLJModelRegistryTools.jl"/><meta name="description" content="Documentation for MLJModelRegistryTools.jl."/><meta property="og:description" content="Documentation for MLJModelRegistryTools.jl."/><meta property="twitter:description" content="Documentation for MLJModelRegistryTools.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">MLJModelRegistryTools.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../registry_management_tools/">Registry management tools</a></li><li class="is-active"><a class="tocitem" href>Internals</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Internals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Internals</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/dev/docs/src/internals.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h1><p>This page contains documentation for non-public API, for maintainers of MLJModelRegistryTools.jl.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.GenericRegistry" href="#MLJModelRegistryTools.GenericRegistry"><code>MLJModelRegistryTools.GenericRegistry</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GenericRegistry</code></pre><p>Module providing basic tools to manage a <em>package registry</em>, by which is meant a package environment, together with &quot;package metata&quot;, in the form of a dictionary of TOML-parsable values, keyed on the environment&#39;s package dependencies, which is stored in a TOML file. (This file is called Metadata.toml and is located in the same folder as environment Project.toml file.) Not to be confused with a package registry in the sense of the standard library, <code>Pkg</code>.</p><p><strong>Methods</strong></p><ul><li><p><code>GenericRegistry.dependencies(environment)</code>: Get a list of the environment&#39;s dependencies (vector of package name strings).</p></li><li><p><a href="#MLJModelRegistryTools.GenericRegistry.put-Tuple{Any, Any, Any}"><code>GenericRegistry.put</code></a>: Insert an item in the metadata dictionary</p></li><li><p><a href="#MLJModelRegistryTools.GenericRegistry.get-Tuple{Any, Any}"><code>GenericRegistry.get</code></a>: Inspect the metadata</p></li><li><p><a href="#MLJModelRegistryTools.GenericRegistry.gc-Tuple{Any}"><code>GenericRegistry.gc</code></a>: Remove key-value pairs fromn the metadata for package keys no longer dependencies in the environment. (In any case, <code>get</code> will return <code>nothing</code> for any <code>pkg</code> not currently a dependency.)</p></li><li><p><a href="#MLJModelRegistryTools.GenericRegistry.run-Tuple{Any, Any, Any}"><code>GenericRegistry.run</code></a>: In a new Julia process, load a package or packages and execute a Julia expression there; results are returned as <code>Future</code> objects, to allow asynchronous <code>run</code> calls. Useful for generating metadata about a package.</p></li><li><p><a href="#MLJModelRegistryTools.GenericRegistry.close-Tuple{Any}"><code>GenericRegistry.close(future)</code></a>: Shut down the process intitiated by the <code>run</code> call that returned <code>future</code> (after calling <code>fetch(future)</code> to get the result of evaluation).</p></li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">using Pkg
env = &quot;/Users/anthony/MyEnv&quot;
Pkg.activate(env)
Pkg.status()
# Status `~/MyEnv/Project.toml`
#  [7876af07] Example v0.5.5
#  [bd369af6] Tables v1.12.1

Pkg.activate(temp=true)
Pkg.add(&quot;MLJModelRegistryTools&quot;)
using MLJModelRegistryTools.GenericRegistry
packages = GenericRegistry.dependencies(env)
# 2-element Vector{String}:
#  &quot;Tables&quot;
#  &quot;Example&quot;

future = GenericRegistry.run([&quot;Tables&quot;,], :(names(Tables)))
value = fetch(future)
# 3-element Vector{Symbol}:
#  :Tables
#  :columntable
#  :rowtable

GenericRegistry.close(future)
GenericRegistry.put(&quot;Tables&quot;, string.(value), env)
read(&quot;/Users/anthony/MyEnv/Metadata.toml&quot;, String)
# &quot;Tables = [&quot;Tables&quot;, &quot;columntable&quot;, &quot;rowtable&quot;]
&quot;

GenericRegistry.get(&quot;Tables&quot;, env)
# 3-element Vector{String}:
#  &quot;Tables&quot;
#  &quot;columntable&quot;
#  &quot;rowtable&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/GenericRegistry.jl#L2-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.GenericRegistry.close-Tuple{Any}" href="#MLJModelRegistryTools.GenericRegistry.close-Tuple{Any}"><code>MLJModelRegistryTools.GenericRegistry.close</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GenericRegistry.close(future)</code></pre><p>Shut down the Julia process whose output was encapsulated by the <code>Future</code> instance, <code>future</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/GenericRegistry.jl#L183-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.GenericRegistry.gc-Tuple{Any}" href="#MLJModelRegistryTools.GenericRegistry.gc-Tuple{Any}"><code>MLJModelRegistryTools.GenericRegistry.gc</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GenericRegistry.gc(environment)</code></pre><p>Remove key-value pairs from the metadata dictionary associated with the specified <code>environment</code> in all cases in which the key is not a package dependency. An optional cleanup operation after removing a package from the environment&#39;s dependencies.</p><p>Does not change behaviour of metadata methods.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/GenericRegistry.jl#L225-L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.GenericRegistry.get-Tuple{Any, Any}" href="#MLJModelRegistryTools.GenericRegistry.get-Tuple{Any, Any}"><code>MLJModelRegistryTools.GenericRegistry.get</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GenericRegistry.get(pkg, environment)</code></pre><p>Return the metadata associated with package, <code>pkg</code>, if it is a dependency of <code>environment</code> and if <code>pkg</code> is a key in associated metadata dictionary. Otherwise, return <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/GenericRegistry.jl#L210-L216">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.GenericRegistry.put-Tuple{Any, Any, Any}" href="#MLJModelRegistryTools.GenericRegistry.put-Tuple{Any, Any, Any}"><code>MLJModelRegistryTools.GenericRegistry.put</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GenericRegistry.put(pkg, value, environment)</code></pre><p>In the metata dictionary associated with specified package environment, assign <code>value</code> to the key <code>pkg</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/GenericRegistry.jl#L192-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.GenericRegistry.run-Tuple{Any, Any, Any}" href="#MLJModelRegistryTools.GenericRegistry.run-Tuple{Any, Any, Any}"><code>MLJModelRegistryTools.GenericRegistry.run</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GenericRegistry.run([setup,] packages, program; environment=nothing)</code></pre><p>Assuming a package <code>environment</code> path is specified, do the following in a new Julia process:</p><ol><li><p>Activate <code>environment</code>.</p></li><li><p>Evaluate the <code>setup</code> expression, if specified.</p></li><li><p>Instantiate the environment.</p></li><li><p><code>import</code> all packages specified in <code>packages</code>.</p></li><li><p>Evaluate the <code>program</code> expression.</p></li></ol><p>The returned value is a <code>Future</code> object which must be <code>fetch</code>ed to get the final evaluated expression. Shut the temporary process down by calling <code>GenericRegistry.close</code> on the <code>Future</code>.</p><p>Step 3 might typically close by reversing any actions mutating the <code>environment</code>, but remember only the last evaluated expression is passed to the <code>Future</code>.</p><p>If <code>environment</code> is unspecified, then a fresh temporary environment is activated, and the packages listed in <code>packages</code> are manually added between Steps 2 and 3 above.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/GenericRegistry.jl#L113-L139">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.registry_path" href="#MLJModelRegistryTools.registry_path"><code>MLJModelRegistryTools.registry_path</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MLJModelRegistryTools.registry_path()</code></pre><p><em>Private method.</em></p><p>Return the path to the registry to which management tools such as <a href="../registry_management_tools/#MLJModelRegistryTools.update"><code>update</code></a> are to be applied. Use <a href="../registry_management_tools/#MLJModelRegistryTools.setpath"><code>setpath</code></a> to change.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/setpath.jl#L12-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.metadata" href="#MLJModelRegistryTools.metadata"><code>MLJModelRegistryTools.metadata</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">metadata(pkg; registry=&quot;&quot;, check_traits=true)</code></pre><p><em>Private method.</em></p><p>Extract the metadata for a package. Returns a <code>Future</code> object that must be <code>fetch</code>ed to get the metadata. See, <a href="../registry_management_tools/#MLJModelRegistryTools.update"><code>MLJModelRegistryTools.update</code></a>, which calls this method, for more details.</p><p>Assumes that MLJModelRegistryTools has been <code>develop</code>ed into <code>registry</code> if this is non-empty.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/methods.jl#L50-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.encode_dic" href="#MLJModelRegistryTools.encode_dic"><code>MLJModelRegistryTools.encode_dic</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">encode_dic(d)</code></pre><p>Convert an arbitrary nested dictionary <code>d</code> into a nested dictionary whose leaf values are all strings, suitable for writing to a TOML file (a poor man&#39;s serialization). The rules for converting leaves are:</p><ol><li><p>If it&#39;s a <code>Symbol</code>, preserve the colon, as in :x -&gt; &quot;:x&quot;.</p></li><li><p>If it&#39;s an <code>AbstractString</code>, apply <code>string</code> function (e.g, to remove <code>SubString</code>s).</p></li><li><p>In all other cases, except <code>AbstractArray</code>s, wrap in single quotes, as in sum -&gt; &quot;<code>sum</code>&quot;.</p></li><li><p>Replace any <code>#</code> character in the application of Rule 3 with <code>_</code> (to handle <code>gensym</code> names)</p></li><li><p>For an <code>AbstractVector</code>, broadcast the preceding Rules over its elements.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/remote_methods.jl#L43-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.modeltype_given_constructor-Tuple{Any}" href="#MLJModelRegistryTools.modeltype_given_constructor-Tuple{Any}"><code>MLJModelRegistryTools.modeltype_given_constructor</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">model_type_given_constructor(modeltypes)</code></pre><p><strong>Private method.</strong></p><p>Return a dictionary of <code>modeltypes</code>, keyed on constructor. Where multiple types share a single constructor, there can only be one value (and which value appears is not predictable).</p><p>Typically a model type and it&#39;s constructor have the same name, but for wrappers, such as <code>TunedModel</code>, several types share the same constructor (e.g., <code>DeterministicTunedModel</code>, <code>ProbabilisticTunedModel</code> are model types sharing constructor <code>TunedModel</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/remote_methods.jl#L16-L29">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MLJModelRegistryTools.traits_given_constructor_name" href="#MLJModelRegistryTools.traits_given_constructor_name"><code>MLJModelRegistryTools.traits_given_constructor_name</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MLJModelRegistryTools.traits_given_constructor_name(pkg; check_traits=true)</code></pre><p>Build and return a dictionary of model metadata as follows: The keys consist of the names of constructors of any <code>model</code> object subtyping <code>MLJModelInterface.Model</code> wherever the package providing the model implementation (assumed to be imported) is <code>pkg</code>. This is the package appearing as the root of <code>MLJModelInterface.load_path(model)</code>. The values are corresponding dictionaries of traits, keyed on trait name.</p><p>Poor man&#39;s serialization, as provided by [<code>MLJRegistry.encode_dic</code>)(@ref), is applied to the dictionary, to make it suitable for writing to TOML files.</p><p>Also, apply smoke tests to the associated trait definitions, assuming <code>check_traits=true</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaAI/MLJModelRegistryTools.jl/blob/30740517ffd63ed9ddc4fa10f43635dc3d72ce22/src/remote_methods.jl#L82-L96">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../registry_management_tools/">« Registry management tools</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Saturday 19 July 2025 22:26">Saturday 19 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
